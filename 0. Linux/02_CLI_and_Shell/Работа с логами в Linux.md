## 1. Где искать логи?

Подавляющее большинство логов в Linux хранится в директории `/var/log/`. Доступ к большинству из них требует прав суперпользователя (`sudo`).

|Путь к файлу|Описание|
|---|---|
|`/var/log/syslog` (Debian/Ubuntu)|Общие системные сообщения ядра и служб.|
|`/var/log/messages` (RHEL/CentOS/Fedora)|Аналог `syslog` для систем Red Hat.|
|`/var/log/auth.log` (Debian/Ubuntu)|Логи аутентификации, попытки входа (SSH, sudo).|
|`/var/log/secure` (RHEL/CentOS)|Аналог `auth.log` для систем Red Hat.|
|`/var/log/kern.log`|Сообщения ядра (kernel) и данные о работе оборудования.|
|`/var/log/dmesg`|Буфер сообщений ядра, записанных при загрузке системы.|
|`/var/log/apache2/` или `/var/log/nginx/`|Логи веб-серверов (access.log, error.log).|
|`/var/log/mysql/` или `/var/log/postgresql/`|Логи баз данных.|
|`/var/log/cloud-init.log`|Логи инициализации облачных инстансов (AWS, Azure, GCP).|

## 2. Основные утилиты просмотра логов

Используйте эти команды для быстрого доступа к содержимому файлов.

##### A. `cat`, `head`, `tail` (Статичный просмотр)

Эти команды подходят для просмотра содержимого файлов целиком или их частей.

```bash
# Просмотреть весь файл (не рекомендуется для больших логов)
sudo cat /var/log/syslog

# Просмотреть первые 10 строк
sudo head /var/log/syslog

# Просмотреть последние 10 строк (самые свежие записи)
sudo tail /var/log/syslog
```

##### B. `tail -f` (Динамический просмотр в реальном времени)

**Самая частая команда для SysAdmin/DevOps.** Она "следит" за файлом и выводит новые строки по мере их появления (как команда `watch`).

```bash
# Следить за логом в реальном времени (нажать Ctrl+C для выхода)
sudo tail -f /var/log/syslog

# Следить за логом и показать последние 50 строк сразу
sudo tail -n 50 -f /var/log/syslog

# Отслеживание нескольких файлов одновременно
sudo tail -f /var/log/auth.log /var/log/kern.log
```

##### C. `less` (Интерактивный просмотр больших файлов)

Идеально подходит для просмотра больших файлов, так как загружает их постранично и позволяет осуществлять навигацию и поиск.

```bash
sudo less /var/log/syslog
```

**Навигация в `less`:**

- **`Page Up` / `Page Down`**: прокрутка страниц.
- **`j` / `k`**: прокрутка построчно.
- **`/`**: поиск вперед (введите текст и нажмите `Enter`).
- **`n`**: перейти к следующему совпадению поиска.
- **`N`**: перейти к предыдущему совпадению поиска.
- **`G`**: перейти в конец файла.
- **`g`**: перейти в начало файла.
- **`q`**: выйти из `less`.

##### D. `grep` (Фильтрация содержимого)

Используется для поиска конкретных ключевых слов, ошибок или IP-адресов в логах.

```bash
# Найти все строки, содержащие слово "ERROR" (регистрозависимо)
grep "ERROR" /var/log/syslog

# Найти все строки, содержащие слово "error" или "ERROR" (без учета регистра)
grep -i "error" /var/log/syslog

# Найти строки, исключая (инвертируя) заданное слово (например, исключить "info")
grep -v "info" /var/log/syslog

# Комбинирование tail -f и grep для мониторинга в реальном времени с фильтрацией
sudo tail -f /var/log/syslog | grep "sshd"
```


## 3. "Фишки" и продвинутые приемы

##### A. Чтение сжатых (ротированных) логов

Система Linux автоматически архивирует старые логи с помощью `logrotate`, добавляя расширение `.gz`.

- **Неправильно:** `cat /var/log/syslog.1.gz | gunzip`
- **Правильно (используйте `zcat`, `zgrep`, `zless`):**

```bash
# Просмотр сжатого файла без его распаковки
zcat /var/log/syslog.1.gz

# Интерактивный просмотр сжатого файла
zless /var/log/syslog.1.gz

# Поиск в сжатом файле
zgrep "ERROR" /var/log/syslog.1.gz
```

##### B. Использование `journalctl` (Для систем с systemd)

Современные дистрибутивы (Ubuntu 16+, CentOS 7+, Fedora) используют `systemd-journald` для сбора логов в бинарном формате. `journalctl` — это утилита для их чтения.

```bash
# Просмотреть все логи с начала загрузки системы
sudo journalctl

# Просмотреть логи только за текущую загрузку (-b = boot)
sudo journalctl -b

# Следить за логами в реальном времени (аналог tail -f)
sudo journalctl -f

# Просмотреть логи определенной службы (например, nginx)
sudo journalctl -u nginx.service

# Показать логи за определенный период времени
sudo journalctl --since "2 hours ago"
sudo journalctl --since "2024-01-01" --until "2024-01-02 03:00"

# Вывод логов в классическом формате syslog
sudo journalctl -o cat
```

##### C. Подсветка вывода с помощью `ccze`

Утилита `ccze` (возможно, потребуется установка: `sudo apt install ccze` или `sudo yum install ccze`) автоматически раскрашивает вывод логов, делая их гораздо легче для чтения.

```bash
sudo tail -f /var/log/syslog | ccze
```