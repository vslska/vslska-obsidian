
Собраны основные команды для проверки пользователей, групп и прав доступа как на **автономных серверах Linux**, так и в **доменных средах** (например, с SSSD и Active Directory/LDAP).

### 1. Базовые Команды Linux (Автономные серверы)

Используйте эти команды для локальных пользователей и стандартных прав POSIX.
#####  Просмотр Пользователей и Групп

|Описание Задачи|Команда Bash|Примечание|
|---|---|---|
|**Список всех локальных пользователей**|`getent passwd`|Читает `/etc/passwd`|
|**Проверить группы пользователя**|`id [имя_пользователя]`|Покажет UID, GID и все группы|
|**Список участников группы**|`getent group [имя_группы]`|Покажет всех, кто состоит в группе|
|**Проверить права `sudo`**|`groups [имя_пользователя]`|Ищите группу `sudo` или `wheel`|

##### Права Доступа к Файлам (`ls -l`)

Основной инструмент для проверки разрешений файлов и каталогов.

```bash
ls -l [путь_к_объекту]
ls -ld [путь_к_каталогу] # Для проверки прав самого каталога
```

**Пример вывода:**  

`-rw-r--r-- 1 user group 4096 Apr 14 09:00 filename.txt`

|Позиция|Описание|
|---|---|
|**1 символ**|Тип (`-` файл, `d` каталог)|
|**2-4 символы**|Права **владельца** (`user`)|
|**5-7 символы**|Права **группы** (`group`)|
|**8-10 символы**|Права **остальных** пользователей|

## 2. Фишки: Работа с Доступами в Доменных Средах (SSSD/AD/LDAP)

Если ваш сервер подключен к домену (Active Directory или FreeIPA) с помощью **SSSD** (System Security Services Daemon), команды `getent` становятся мощнее. Они могут читать как локальную базу данных, так и данные из домена.

##### Диагностика SSSD

- **Проверить статус службы SSSD:**
```bash
systemctl status sssd
```

- **Принудительно очистить кэш SSSD** (полезно, если вы уверены, что права в AD изменились, а на сервере — нет):
```bash
sudo sssd_cache -E
# Затем перезапустить службу, чтобы изменения вступили в силу немедленно:
sudo systemctl restart sssd
```


##### Чтение Доменных Пользователей и Групп через SSSD

Команды остаются теми же, но теперь они ищут информацию в централизованном источнике:
```bash
# Получить информацию о доменном пользователе (имя_пользователя@домен)
getent passwd [имя_пользователя]@[имя_домена]

# Получить информацию о доменной группе
getent group [имя_группы]@[имя_домена]

# Проверить все группы, включая доменные, для конкретного пользователя
id [имя_пользователя]@[имя_домена]
```


##### Проверка Членства в AD-Группах для Файловых Доступов

В доменных средах разрешения на файлы часто выдаются доменным группам. Убедитесь, что SSSD корректно маппит (сопоставляет) SID (идентификаторы безопасности AD) в локальные GID (идентификаторы групп Linux).

Если пользователь **ЯВНО** не имеет доступа к файлу, но должен иметь его через доменную группу, используйте `id`, чтобы убедиться, что эта группа есть в его списке **текущих** активных групп на сервере.


--- 
## 3. Расширенные Права (ACL)

Используются для более детального контроля доступа, выходящего за рамки стандартных Владелец/Группа/Остальные.

- **Просмотреть ACL для файла/каталога:**
```bash
getfacl [путь_к_файлу_или_каталогу]
```

- **Установить/изменить ACL (пример):**
```bash
# Дать пользователю 'user_x' право чтения и записи к файлу
setfacl -m u:user_x:rw [файл]
```
