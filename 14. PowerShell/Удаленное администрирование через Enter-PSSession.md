`Enter-PSSession` предоставляет интерактивную, текстовую консоль для управления удаленными компьютерами Windows. Это аналог SSH в мире Windows, позволяющий работать в духе Linux.

### 1. Подготовка удаленного хоста (Единоразовая настройка)

На **удаленном** компьютере необходимо разрешить удаленное взаимодействие (PowerShell Remoting). Запустите PowerShell **от имени администратора** и выполните команду:
```powershell
Enable-PSRemoting -Force
```

### 2. Установление сеанса

Чтобы подключиться к удаленной машине `SERVER01` из вашей локальной консоли:
```powershell
Enter-PSSession -ComputerName SERVER01
```

После выполнения команды ваша командная строка изменится, например, с `PS C:\>` на `[SERVER01]: PS C:\>`. Все команды, выполняемые теперь, происходят на удаленном сервере.

#### 2.1. Подключение с административными привилегиями

Чтобы гарантировать права администратора на удаленной стороне, используйте параметр `-Credential` с учетной записью, которая имеет права локального администратора на _удаленном_ хосте:


```powershell
# Замените 'AdminUser' на имя вашего удаленного администратора
Enter-PSSession -ComputerName SERVER01 -Credential AdminUser
```

Появится графическое окно ввода пароля. После ввода пароля вы получите сеанс с полными правами администратора на `SERVER01`.

#### 2.2. Использование конкретного протокола (WSMAN)

По умолчанию PowerShell Remoting использует протокол WS-Management (порт 5985 HTTP или 5986 HTTPS). Для настройки конкретного порта или проверки:
```powershell
Enter-PSSession -ComputerName SERVER01 -Port 5985
```

### 3. Завершение сеанса

Чтобы выйти из удаленного сеанса и вернуться в локальную консоль, используйте команду `Exit-PSSession` или просто `exit`:
```powershell
Exit-PSSession
```

Use code with caution.